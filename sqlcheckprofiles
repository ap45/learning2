DECLARE @Threshold FLOAT = 0.7;

DECLARE @DynamicSQL NVARCHAR(MAX);
SET @DynamicSQL = '
SELECT profile_id
FROM profile
WHERE (
    (SELECT COUNT(*) FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = ''profile'' AND TABLE_SCHEMA = ''dbo'') - 
    (SELECT COUNT(*) FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = ''profile'' AND TABLE_SCHEMA = ''dbo'' AND ' + 
    STUFF((SELECT ' + ' + ISNULL(' + COLUMN_NAME + ', 0) AS ' + COLUMN_NAME + ', '
            FROM INFORMATION_SCHEMA.COLUMNS
            WHERE TABLE_NAME = 'profile' AND TABLE_SCHEMA = 'dbo'
            FOR XML PATH('')), 1, 2, '') + ')) /
    CAST((SELECT COUNT(*) FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = ''profile'' AND TABLE_SCHEMA = ''dbo'') AS FLOAT)
) > ' + CAST(@Threshold AS NVARCHAR(50));

EXEC sp_executesql @DynamicSQL;
