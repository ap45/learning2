DECLARE @Threshold FLOAT = 0.7;
DECLARE @SQL NVARCHAR(MAX);
DECLARE @ColumnsCount INT;

SELECT @ColumnsCount = COUNT(*)
FROM INFORMATION_SCHEMA.COLUMNS
WHERE TABLE_NAME = 'RPM_PROFILE_T';

SET @SQL = '
SELECT PR_ID
FROM RPM_PROFILE_T
WHERE (
    (';

SELECT @SQL = @SQL + 
                'CASE WHEN [' + COLUMN_NAME + '] IS NOT NULL THEN 1 ELSE 0 END + '
FROM INFORMATION_SCHEMA.COLUMNS
WHERE TABLE_NAME = 'RPM_PROFILE_T';

SET @SQL = LEFT(@SQL, LEN(@SQL) - 3) + ') > (' + CAST(@Threshold * @ColumnsCount AS NVARCHAR(10)) + ')
)';

EXEC(@SQL);
